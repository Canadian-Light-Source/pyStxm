import os
from bluesky.plans import count, scan, grid_scan
import bluesky.plan_stubs as bps
import bluesky.preprocessors as bpp
from bluesky.utils import FailedStatus

from ophyd.utils import (ReadOnlyError, LimitError, DestroyedError)
from bcm.devices.ophyd.qt.daqmx_counter_output import trig_src_types

from cls.scan_engine.bluesky.bluesky_defs import bs_dev_modes
from cls.applications.pyStxm import abs_path_to_ini_file
from cls.applications.pyStxm.main_obj_init import MAIN_OBJ

from cls.scanning.BaseScan import BaseScan, SIM_SPEC_DATA, SIMULATE_SPEC_DATA
from cls.types.stxmTypes import (
    scan_types,
    scan_sub_types,
    energy_scan_order_types,
    sample_positioning_modes,
    sample_fine_positioning_modes,
)
from cls.scanning.scan_cfg_utils import ensure_valid_values, calc_accRange
from cls.utils.roi_dict_defs import *
from cls.utils.log import get_module_logger
from cls.utils.cfgparser import ConfigClass
from cls.utils.dict_utils import dct_put, dct_get
from cls.utils.json_utils import dict_to_json
from cls.plotWidgets.utils import *
abs_path_to_ini_file = "C:/controls/sandbox/pyStxm3/cls/applications/pyStxm/app.ini"

_logger = get_module_logger(__name__)

appConfig = ConfigClass(abs_path_to_ini_file)

x_roi = {'NAME': 'X',
     'ID': 'BASE_ROI',
     'ID_VAL': -1,
     'CENTER': 0.0,
     'RANGE': 2000.0,
     'NPOINTS': 300,
     'ENABLED': True,
     'IS_POINT': False,
     'OFFSET': 0.0,
     'STEP': 6.688963210702341,
     'START': -1000.0,
     'STOP': 1000.0,
     'SETPOINTS': array([-1000.        ,  -993.31103679,  -986.62207358,  -979.93311037,
             -973.24414716,  -966.55518395,  -959.86622074,  -953.17725753,
             -946.48829431,  -939.7993311 ,  -933.11036789,  -926.42140468,
             -919.73244147,  -913.04347826,  -906.35451505,  -899.66555184,
             -892.97658863,  -886.28762542,  -879.59866221,  -872.909699  ,
             -866.22073579,  -859.53177258,  -852.84280936,  -846.15384615,
             -839.46488294,  -832.77591973,  -826.08695652,  -819.39799331,
             -812.7090301 ,  -806.02006689,  -799.33110368,  -792.64214047,
             -785.95317726,  -779.26421405,  -772.57525084,  -765.88628763,
             -759.19732441,  -752.5083612 ,  -745.81939799,  -739.13043478,
             -732.44147157,  -725.75250836,  -719.06354515,  -712.37458194,
             -705.68561873,  -698.99665552,  -692.30769231,  -685.6187291 ,
             -678.92976589,  -672.24080268,  -665.55183946,  -658.86287625,
             -652.17391304,  -645.48494983,  -638.79598662,  -632.10702341,
             -625.4180602 ,  -618.72909699,  -612.04013378,  -605.35117057,
             -598.66220736,  -591.97324415,  -585.28428094,  -578.59531773,
             -571.90635452,  -565.2173913 ,  -558.52842809,  -551.83946488,
             -545.15050167,  -538.46153846,  -531.77257525,  -525.08361204,
             -518.39464883,  -511.70568562,  -505.01672241,  -498.3277592 ,
             -491.63879599,  -484.94983278,  -478.26086957,  -471.57190635,
             -464.88294314,  -458.19397993,  -451.50501672,  -444.81605351,
             -438.1270903 ,  -431.43812709,  -424.74916388,  -418.06020067,
             -411.37123746,  -404.68227425,  -397.99331104,  -391.30434783,
             -384.61538462,  -377.9264214 ,  -371.23745819,  -364.54849498,
             -357.85953177,  -351.17056856,  -344.48160535,  -337.79264214,
             -331.10367893,  -324.41471572,  -317.72575251,  -311.0367893 ,
             -304.34782609,  -297.65886288,  -290.96989967,  -284.28093645,
             -277.59197324,  -270.90301003,  -264.21404682,  -257.52508361,
             -250.8361204 ,  -244.14715719,  -237.45819398,  -230.76923077,
             -224.08026756,  -217.39130435,  -210.70234114,  -204.01337793,
             -197.32441472,  -190.63545151,  -183.94648829,  -177.25752508,
             -170.56856187,  -163.87959866,  -157.19063545,  -150.50167224,
             -143.81270903,  -137.12374582,  -130.43478261,  -123.7458194 ,
             -117.05685619,  -110.36789298,  -103.67892977,   -96.98996656,
              -90.30100334,   -83.61204013,   -76.92307692,   -70.23411371,
              -63.5451505 ,   -56.85618729,   -50.16722408,   -43.47826087,
              -36.78929766,   -30.10033445,   -23.41137124,   -16.72240803,
              -10.03344482,    -3.34448161,     3.34448161,    10.03344482,
               16.72240803,    23.41137124,    30.10033445,    36.78929766,
               43.47826087,    50.16722408,    56.85618729,    63.5451505 ,
               70.23411371,    76.92307692,    83.61204013,    90.30100334,
               96.98996656,   103.67892977,   110.36789298,   117.05685619,
              123.7458194 ,   130.43478261,   137.12374582,   143.81270903,
              150.50167224,   157.19063545,   163.87959866,   170.56856187,
              177.25752508,   183.94648829,   190.63545151,   197.32441472,
              204.01337793,   210.70234114,   217.39130435,   224.08026756,
              230.76923077,   237.45819398,   244.14715719,   250.8361204 ,
              257.52508361,   264.21404682,   270.90301003,   277.59197324,
              284.28093645,   290.96989967,   297.65886288,   304.34782609,
              311.0367893 ,   317.72575251,   324.41471572,   331.10367893,
              337.79264214,   344.48160535,   351.17056856,   357.85953177,
              364.54849498,   371.23745819,   377.9264214 ,   384.61538462,
              391.30434783,   397.99331104,   404.68227425,   411.37123746,
              418.06020067,   424.74916388,   431.43812709,   438.1270903 ,
              444.81605351,   451.50501672,   458.19397993,   464.88294314,
              471.57190635,   478.26086957,   484.94983278,   491.63879599,
              498.3277592 ,   505.01672241,   511.70568562,   518.39464883,
              525.08361204,   531.77257525,   538.46153846,   545.15050167,
              551.83946488,   558.52842809,   565.2173913 ,   571.90635452,
              578.59531773,   585.28428094,   591.97324415,   598.66220736,
              605.35117057,   612.04013378,   618.72909699,   625.4180602 ,
              632.10702341,   638.79598662,   645.48494983,   652.17391304,
              658.86287625,   665.55183946,   672.24080268,   678.92976589,
              685.6187291 ,   692.30769231,   698.99665552,   705.68561873,
              712.37458194,   719.06354515,   725.75250836,   732.44147157,
              739.13043478,   745.81939799,   752.5083612 ,   759.19732441,
              765.88628763,   772.57525084,   779.26421405,   785.95317726,
              792.64214047,   799.33110368,   806.02006689,   812.7090301 ,
              819.39799331,   826.08695652,   832.77591973,   839.46488294,
              846.15384615,   852.84280936,   859.53177258,   866.22073579,
              872.909699  ,   879.59866221,   886.28762542,   892.97658863,
              899.66555184,   906.35451505,   913.04347826,   919.73244147,
              926.42140468,   933.11036789,   939.7993311 ,   946.48829431,
              953.17725753,   959.86622074,   966.55518395,   973.24414716,
              979.93311037,   986.62207358,   993.31103679,  1000.        ]),
     'POSITIONER': 'DNM_SAMPLE_X',
     'SRC': None,
     'TOP_LEVEL': False,
     'DATA_LEVEL': False,
     'SCAN_RES': 'COARSE',
     'RECT': (-1000.0, -1000.0, 1000.0, 1000.0)}
y_roi = {'NAME': 'Y',
     'ID': 'BASE_ROI',
     'ID_VAL': -1,
     'CENTER': -804.26,
     'RANGE': 2000.0,
     'NPOINTS': 100,
     'ENABLED': True,
     'IS_POINT': False,
     'OFFSET': 0.0,
     'STEP': 20.2020202020202,
     'START': -1804.26,
     'STOP': 195.74,
     'SETPOINTS': array([-1804.26      , -1784.0579798 , -1763.8559596 , -1743.65393939,
            -1723.45191919, -1703.24989899, -1683.04787879, -1662.84585859,
            -1642.64383838, -1622.44181818, -1602.23979798, -1582.03777778,
            -1561.83575758, -1541.63373737, -1521.43171717, -1501.22969697,
            -1481.02767677, -1460.82565657, -1440.62363636, -1420.42161616,
            -1400.21959596, -1380.01757576, -1359.81555556, -1339.61353535,
            -1319.41151515, -1299.20949495, -1279.00747475, -1258.80545455,
            -1238.60343434, -1218.40141414, -1198.19939394, -1177.99737374,
            -1157.79535354, -1137.59333333, -1117.39131313, -1097.18929293,
            -1076.98727273, -1056.78525253, -1036.58323232, -1016.38121212,
             -996.17919192,  -975.97717172,  -955.77515152,  -935.57313131,
             -915.37111111,  -895.16909091,  -874.96707071,  -854.76505051,
             -834.5630303 ,  -814.3610101 ,  -794.1589899 ,  -773.9569697 ,
             -753.75494949,  -733.55292929,  -713.35090909,  -693.14888889,
             -672.94686869,  -652.74484848,  -632.54282828,  -612.34080808,
             -592.13878788,  -571.93676768,  -551.73474747,  -531.53272727,
             -511.33070707,  -491.12868687,  -470.92666667,  -450.72464646,
             -430.52262626,  -410.32060606,  -390.11858586,  -369.91656566,
             -349.71454545,  -329.51252525,  -309.31050505,  -289.10848485,
             -268.90646465,  -248.70444444,  -228.50242424,  -208.30040404,
             -188.09838384,  -167.89636364,  -147.69434343,  -127.49232323,
             -107.29030303,   -87.08828283,   -66.88626263,   -46.68424242,
              -26.48222222,    -6.28020202,    13.92181818,    34.12383838,
               54.32585859,    74.52787879,    94.72989899,   114.93191919,
              135.13393939,   155.3359596 ,   175.5379798 ,   195.74      ]),
     'POSITIONER': 'DNM_SAMPLE_Y',
     'SRC': None,
     'TOP_LEVEL': False,
     'DATA_LEVEL': False,
     'SCAN_RES': 'COARSE',
     'RECT': (-1804.26, -1804.26, 195.74, 195.74)}

dev_list = [OphydQt_AIDevice(prefix='TM1610-3-I12-01', name='TM1610-3-I12-01', read_attrs=['val'], configuration_attrs=[]),
     OphydQt_AIDevice(prefix='TM1610-3-I12-30', name='TM1610-3-I12-30', read_attrs=['val'], configuration_attrs=[]),
     OphydQt_AIDevice(prefix='TM1610-3-I12-32', name='TM1610-3-I12-32', read_attrs=['val'], configuration_attrs=[]),
     OphydQt_AIDevice(prefix='TM1610-3-I12-21', name='TM1610-3-I12-21', read_attrs=['val'], configuration_attrs=[]),
     OphydQt_AIDevice(prefix='TM1610-3-I12-22', name='TM1610-3-I12-22', read_attrs=['val'], configuration_attrs=[]),
     OphydQt_AIDevice(prefix='TM1610-3-I12-23', name='TM1610-3-I12-23', read_attrs=['val'], configuration_attrs=[]),
     OphydQt_AIDevice(prefix='TM1610-3-I12-24', name='TM1610-3-I12-24', read_attrs=['val'], configuration_attrs=[]),
     OphydQt_AIDevice(prefix='CCG1410-01:vac:p', name='CCG1410-01:vac:p', read_attrs=['val'], configuration_attrs=[]),
     OphydQt_AIDevice(prefix='CCG1410-I00-01:vac:p', name='CCG1410-I00-01:vac:p', read_attrs=['val'], configuration_attrs=[]),
     OphydQt_AIDevice(prefix='CCG1410-I00-02:vac:p', name='CCG1410-I00-02:vac:p', read_attrs=['val'], configuration_attrs=[]),
     OphydQt_AIDevice(prefix='CCG1610-1-I00-02:vac:p', name='CCG1610-1-I00-02:vac:p', read_attrs=['val'], configuration_attrs=[]),
     OphydQt_AIDevice(prefix='HCG1610-1-I00-01:vac:p', name='HCG1610-1-I00-01:vac:p', read_attrs=['val'], configuration_attrs=[]),
     OphydQt_AIDevice(prefix='CCG1610-1-I00-03:vac:p', name='CCG1610-1-I00-03:vac:p', read_attrs=['val'], configuration_attrs=[]),
     OphydQt_AIDevice(prefix='CCG1610-I10-01:vac:p', name='CCG1610-I10-01:vac:p', read_attrs=['val'], configuration_attrs=[]),
     OphydQt_AIDevice(prefix='CCG1610-I10-03:vac:p', name='CCG1610-I10-03:vac:p', read_attrs=['val'], configuration_attrs=[]),
     OphydQt_AIDevice(prefix='CCG1610-I10-04:vac:p', name='CCG1610-I10-04:vac:p', read_attrs=['val'], configuration_attrs=[]),
     OphydQt_AIDevice(prefix='CCG1610-I12-01:vac:p', name='CCG1610-I12-01:vac:p', read_attrs=['val'], configuration_attrs=[]),
     OphydQt_AIDevice(prefix='CCG1610-I12-02:vac:p', name='CCG1610-I12-02:vac:p', read_attrs=['val'], configuration_attrs=[]),
     OphydQt_AIDevice(prefix='CCG1610-3-I12-01:vac:p', name='CCG1610-3-I12-01:vac:p', read_attrs=['val'], configuration_attrs=[]),
     e712_sample_motor(prefix='PZAC1610-3-I12-40', name='PZAC1610-3-I12-40', settle_time=0.0, timeout=None, read_attrs=['user_readback', 'user_setpoint'], configuration_attrs=['user_offset', 'user_offset_dir', 'velocity', 'acceleration', 'motor_egu']),
     e712_sample_motor(prefix='PZAC1610-3-I12-41', name='PZAC1610-3-I12-41', settle_time=0.0, timeout=None, read_attrs=['user_readback', 'user_setpoint'], configuration_attrs=['user_offset', 'user_offset_dir', 'velocity', 'acceleration', 'motor_egu']),
     Motor_Qt(prefix='PZAC1610-3-I12-43', name='PZAC1610-3-I12-43', settle_time=0.0, timeout=None, read_attrs=['user_readback', 'user_setpoint'], configuration_attrs=['user_offset', 'user_offset_dir', 'velocity', 'acceleration', 'motor_egu']),
     Motor_Qt(prefix='PZAC1610-3-I12-44', name='PZAC1610-3-I12-44', settle_time=0.0, timeout=None, read_attrs=['user_readback', 'user_setpoint'], configuration_attrs=['user_offset', 'user_offset_dir', 'velocity', 'acceleration', 'motor_egu']),
     Motor_Qt(prefix='SMTR1610-3-I12-51', name='SMTR1610-3-I12-51', settle_time=0.0, timeout=None, read_attrs=['user_readback', 'user_setpoint'], configuration_attrs=['user_offset', 'user_offset_dir', 'velocity', 'acceleration', 'motor_egu']),
     EpicsMotor(prefix='SMTR1610-3-I12-45', name='SMTR1610-3-I12-45', settle_time=0.0, timeout=None, read_attrs=['user_readback', 'user_setpoint'], configuration_attrs=['user_offset', 'user_offset_dir', 'velocity', 'acceleration', 'motor_egu']),
     EpicsMotor(prefix='SMTR1610-3-I12-46', name='SMTR1610-3-I12-46', settle_time=0.0, timeout=None, read_attrs=['user_readback', 'user_setpoint'], configuration_attrs=['user_offset', 'user_offset_dir', 'velocity', 'acceleration', 'motor_egu']),
     Motor_Qt(prefix='SMTR1610-3-I12-47', name='SMTR1610-3-I12-47', settle_time=0.0, timeout=None, read_attrs=['user_readback', 'user_setpoint'], configuration_attrs=['user_offset', 'user_offset_dir', 'velocity', 'acceleration', 'motor_egu']),
     Motor_Qt(prefix='SMTR1610-3-I12-48', name='SMTR1610-3-I12-48', settle_time=0.0, timeout=None, read_attrs=['user_readback', 'user_setpoint'], configuration_attrs=['user_offset', 'user_offset_dir', 'velocity', 'acceleration', 'motor_egu']),
     Motor_Qt(prefix='SMTR1610-3-I12-49', name='SMTR1610-3-I12-49', settle_time=0.0, timeout=None, read_attrs=['user_readback', 'user_setpoint'], configuration_attrs=['user_offset', 'user_offset_dir', 'velocity', 'acceleration', 'motor_egu']),
     Motor_Qt(prefix='SMTR1610-3-I12-50', name='SMTR1610-3-I12-50', settle_time=0.0, timeout=None, read_attrs=['user_readback', 'user_setpoint'], configuration_attrs=['user_offset', 'user_offset_dir', 'velocity', 'acceleration', 'motor_egu']),
     sample_abstract_motor(prefix='PSMTR1610-3-I12-00', name='PSMTR1610-3-I12-00', settle_time=0.0, timeout=None, read_attrs=['user_readback', 'user_setpoint'], configuration_attrs=['user_offset', 'user_offset_dir', 'velocity', 'acceleration', 'motor_egu']),
     sample_abstract_motor(prefix='PSMTR1610-3-I12-01', name='PSMTR1610-3-I12-01', settle_time=0.0, timeout=None, read_attrs=['user_readback', 'user_setpoint'], configuration_attrs=['user_offset', 'user_offset_dir', 'velocity', 'acceleration', 'motor_egu']),
     Motor_Qt(prefix='SIM_VBL1610-I12:ENERGY', name='SIM_VBL1610-I12:ENERGY', settle_time=0.0, timeout=None, read_attrs=['user_readback', 'user_setpoint'], configuration_attrs=['user_offset', 'user_offset_dir', 'velocity', 'acceleration', 'motor_egu']),
     Motor_Qt(prefix='SIM_VBL1610-I12:slitX', name='SIM_VBL1610-I12:slitX', settle_time=0.0, timeout=None, read_attrs=['user_readback', 'user_setpoint'], configuration_attrs=['user_offset', 'user_offset_dir', 'velocity', 'acceleration', 'motor_egu']),
     Motor_Qt(prefix='SIM_VBL1610-I12:slitY', name='SIM_VBL1610-I12:slitY', settle_time=0.0, timeout=None, read_attrs=['user_readback', 'user_setpoint'], configuration_attrs=['user_offset', 'user_offset_dir', 'velocity', 'acceleration', 'motor_egu']),
     Motor_Qt(prefix='SIM_VBL1610-I12:m3STXMPitch', name='SIM_VBL1610-I12:m3STXMPitch', settle_time=0.0, timeout=None, read_attrs=['user_readback', 'user_setpoint'], configuration_attrs=['user_offset', 'user_offset_dir', 'velocity', 'acceleration', 'motor_egu']),
     Motor_Qt(prefix='SIM_VBL1610-I12:epuGap', name='SIM_VBL1610-I12:epuGap', settle_time=0.0, timeout=None, read_attrs=['user_readback', 'user_setpoint'], configuration_attrs=['user_offset', 'user_offset_dir', 'velocity', 'acceleration', 'motor_egu']),
     Motor_Qt(prefix='SIM_VBL1610-I12:epuOffset', name='SIM_VBL1610-I12:epuOffset', settle_time=0.0, timeout=None, read_attrs=['user_readback', 'user_setpoint'], configuration_attrs=['user_offset', 'user_offset_dir', 'velocity', 'acceleration', 'motor_egu']),
     Motor_Qt(prefix='SIM_VBL1610-I12:epuHarmonic', name='SIM_VBL1610-I12:epuHarmonic', settle_time=0.0, timeout=None, read_attrs=['user_readback', 'user_setpoint'], configuration_attrs=['user_offset', 'user_offset_dir', 'velocity', 'acceleration', 'motor_egu']),
     Motor_Qt(prefix='SIM_VBL1610-I12:epuPolarization', name='SIM_VBL1610-I12:epuPolarization', settle_time=0.0, timeout=None, read_attrs=['user_readback', 'user_setpoint'], configuration_attrs=['user_offset', 'user_offset_dir', 'velocity', 'acceleration', 'motor_egu']),
     Motor_Qt(prefix='SIM_VBL1610-I12:epuAngle', name='SIM_VBL1610-I12:epuAngle', settle_time=0.0, timeout=None, read_attrs=['user_readback', 'user_setpoint'], configuration_attrs=['user_offset', 'user_offset_dir', 'velocity', 'acceleration', 'motor_egu']),
     OphydQt_AIDevice(prefix='TB_ASTXM:bl_api:zp:adjust_zpz', name='DNM_ZPZ_ADJUST', read_attrs=['val'], configuration_attrs=[]),
     OphydQt_AIDevice(prefix='TB_ASTXM:bl_api:delta_A0', name='DNM_DELTA_A0', read_attrs=['val'], configuration_attrs=[]),
     OphydQt_AIDevice(prefix='TB_ASTXM:bl_api:zp:FL', name='DNM_FOCAL_LENGTH', read_attrs=['val'], configuration_attrs=[]),
     OphydQt_AIDevice(prefix='TB_ASTXM:bl_api:A0', name='DNM_A0', read_attrs=['val'], configuration_attrs=[]),
     OphydQt_AIDevice(prefix='TB_ASTXM:bl_api:A0Max', name='DNM_A0MAX', read_attrs=['val'], configuration_attrs=[]),
     OphydQt_AIDevice(prefix='TB_ASTXM:bl_api:zp:zpz_pos', name='DNM_ZPZ_POS', read_attrs=['val'], configuration_attrs=[]),
     OphydQt_AIDevice(prefix='SYSTEM:mode:fbk', name='DNM_SYSTEM_MODE_FBK', read_attrs=['val'], configuration_attrs=[]),
     OphydQt_AIDevice(prefix='SRStatus:shutters', name='DNM_SRSTATUS_SHUTTERS', read_attrs=['val'], configuration_attrs=[]),
     OphydQt_AIDevice(prefix='SIM_SM01PGM01:ENERGY_MON', name='DNM_MONO_EV_FBK', read_attrs=['val'], configuration_attrs=[]),
     OphydQt_AIDevice(prefix='TB_ASTXM:bl_api:zp:defocus', name='DNM_BEAM_DEFOCUS', read_attrs=['val'], configuration_attrs=[]),
     OphydQt_AIDevice(prefix='TB_ASTXM:Ai:ai0_RBV', name='DNM_AX1_INTERFER_VOLTS', read_attrs=['val'], configuration_attrs=[]),
     OphydQt_AIDevice(prefix='PZAC1610-3-I12-40:OutputVolt_RBV', name='DNM_SFX_PIEZO_VOLTS', read_attrs=['val'], configuration_attrs=[]),
     OphydQt_AIDevice(prefix='PZAC1610-3-I12-41:OutputVolt_RBV', name='DNM_SFY_PIEZO_VOLTS', read_attrs=['val'], configuration_attrs=[]),
     OphydQt_AIDevice(prefix='TB_ASTXM:Ai:ai1_RBV', name='DNM_AX2_INTERFER_VOLTS', read_attrs=['val'], configuration_attrs=[]),
     OphydQt_AIDevice(prefix='PCT1402-01:mA:fbk', name='DNM_RING_CURRENT', read_attrs=['val'], configuration_attrs=[]),
     OphydQt_AIDevice(prefix='MCS1610-310-02:mcs:delay', name='DNM_DFLT_PMT_DWELL', read_attrs=['val'], configuration_attrs=[])]

md = {'metadata': '{\n    "data_dir": "G:\\\\nexus\\\\nexusformat\\\\stxm_test\\\\guest\\\\0323",\n    "data_filename": "C230323001.hdf5",\n    "default_det": "GE_CCD",\n    "dwell": 10.0,\n    "entry_name": "entry0",\n    "img_idx_map": "{\\n    \\"e_idx\\": 0,\\n    \\"entry\\": \\"entry0\\",\\n    \\"pol_idx\\": 0,\\n    \\"sp_id\\": 0,\\n    \\"sp_idx\\": 0\\n}",\n    "primary_det": [\n        "DNM_SIS3820_waveform_rbv",\n        "DNM_RING_CURRENT"\n    ],\n    "rev_lu_dct": {\n        "CCG1410-01:vac:p": "CCG1410-01:vac:p",\n        "CCG1410-I00-01:vac:p": "CCG1410-I00-01:vac:p",\n        "CCG1410-I00-02:vac:p": "CCG1410-I00-02:vac:p",\n        "CCG1610-1-I00-02:vac:p": "CCG1610-1-I00-02:vac:p",\n        "CCG1610-1-I00-03:vac:p": "CCG1610-1-I00-03:vac:p",\n        "CCG1610-3-I12-01:vac:p": "CCG1610-3-I12-01:vac:p",\n        "CCG1610-I10-01:vac:p": "CCG1610-I10-01:vac:p",\n        "CCG1610-I10-03:vac:p": "CCG1610-I10-03:vac:p",\n        "CCG1610-I10-04:vac:p": "CCG1610-I10-04:vac:p",\n        "CCG1610-I12-01:vac:p": "CCG1610-I12-01:vac:p",\n        "CCG1610-I12-02:vac:p": "CCG1610-I12-02:vac:p",\n        "DNM_A0": "TB_ASTXM:bl_api:A0",\n        "DNM_A0MAX": "TB_ASTXM:bl_api:A0Max",\n        "DNM_AX1_INTERFER_VOLTS": "TB_ASTXM:Ai:ai0_RBV",\n        "DNM_AX2_INTERFER_VOLTS": "TB_ASTXM:Ai:ai1_RBV",\n        "DNM_BEAM_DEFOCUS": "TB_ASTXM:bl_api:zp:defocus",\n        "DNM_CALCD_ZPZ": "TB_ASTXM:bl_api:zp:fbk:tr.I",\n        "DNM_COARSE_X": "SMTR1610-3-I12-45",\n        "DNM_COARSE_Y": "SMTR1610-3-I12-46",\n        "DNM_COARSE_Z": "SMTR1610-3-I12-47",\n        "DNM_DELTA_A0": "TB_ASTXM:bl_api:delta_A0",\n        "DNM_DETECTOR_X": "SMTR1610-3-I12-48",\n        "DNM_DETECTOR_Y": "SMTR1610-3-I12-49",\n        "DNM_DETECTOR_Z": "SMTR1610-3-I12-50",\n        "DNM_DFLT_PMT_DWELL": "MCS1610-310-02:mcs:delay",\n        "DNM_ENERGY": "SIM_VBL1610-I12:ENERGY",\n        "DNM_ENERGY_ENABLE": "TB_ASTXM:bl_api:enabled",\n        "DNM_ENERGY_RBV": "SIM_VBL1610-I12:ENERGY.RBV",\n        "DNM_EPU_ANGLE": "SIM_VBL1610-I12:epuAngle",\n        "DNM_EPU_GAP": "SIM_VBL1610-I12:epuGap",\n        "DNM_EPU_HARMONIC": "SIM_VBL1610-I12:epuHarmonic",\n        "DNM_EPU_OFFSET": "SIM_VBL1610-I12:epuOffset",\n        "DNM_EPU_POLARIZATION": "SIM_VBL1610-I12:epuPolarization",\n        "DNM_FOCAL_LENGTH": "TB_ASTXM:bl_api:zp:FL",\n        "DNM_IDEAL_A0": "TB_ASTXM:bl_api:zp:fbk:tr.K",\n        "DNM_M3_PITCH": "SIM_VBL1610-I12:m3STXMPitch",\n        "DNM_MONO_EV_FBK": "SIM_SM01PGM01:ENERGY_MON",\n        "DNM_OSA_DEF": "TB_ASTXM:bl_api:osa:def",\n        "DNM_OSA_X": "PZAC1610-3-I12-43",\n        "DNM_OSA_Y": "PZAC1610-3-I12-44",\n        "DNM_RESET_INTERFERS": "PSMTR1610-3-I12-00:reset_interfers",\n        "DNM_RING_CURRENT": "PCT1402-01:mA:fbk",\n        "DNM_SAMPLE_FINE_X": "PZAC1610-3-I12-40",\n        "DNM_SAMPLE_FINE_Y": "PZAC1610-3-I12-41",\n        "DNM_SAMPLE_X": "PSMTR1610-3-I12-00",\n        "DNM_SAMPLE_Y": "PSMTR1610-3-I12-01",\n        "DNM_SCANCOARSE_X": "DNM_SCANCOARSE_X",\n        "DNM_SCANCOARSE_Y": "DNM_SCANCOARSE_Y",\n        "DNM_SFX_AUTOZERO": "PZAC1610-3-I12-40:AutoZero",\n        "DNM_SFX_PIEZO_VOLTS": "PZAC1610-3-I12-40:OutputVolt_RBV",\n        "DNM_SFY_AUTOZERO": "PZAC1610-3-I12-41:AutoZero",\n        "DNM_SFY_PIEZO_VOLTS": "PZAC1610-3-I12-41:OutputVolt_RBV",\n        "DNM_SLIT_X": "SIM_VBL1610-I12:slitX",\n        "DNM_SLIT_Y": "SIM_VBL1610-I12:slitY",\n        "DNM_SRSTATUS_SHUTTERS": "SRStatus:shutters",\n        "DNM_SYSTEM_MODE_FBK": "SYSTEM:mode:fbk",\n        "DNM_ZONEPLATE_SCAN_MODE": "TB_ASTXM:bl_api:zp:scanselflag",\n        "DNM_ZONEPLATE_Z": "SMTR1610-3-I12-51",\n        "DNM_ZPZ_ADJUST": "TB_ASTXM:bl_api:zp:adjust_zpz",\n        "DNM_ZPZ_POS": "TB_ASTXM:bl_api:zp:zpz_pos",\n        "DNM_ZPZ_RBV": "SMTR1610-3-I12-51.RBV",\n        "DNM_ZP_DEF": "TB_ASTXM:bl_api:zp:def",\n        "DNM_ZP_DEF_A": "TB_ASTXM:bl_api:zp:def.A",\n        "HCG1610-1-I00-01:vac:p": "HCG1610-1-I00-01:vac:p",\n        "TM1610-3-I12-01": "TM1610-3-I12-01",\n        "TM1610-3-I12-21": "TM1610-3-I12-21",\n        "TM1610-3-I12-22": "TM1610-3-I12-22",\n        "TM1610-3-I12-23": "TM1610-3-I12-23",\n        "TM1610-3-I12-24": "TM1610-3-I12-24",\n        "TM1610-3-I12-30": "TM1610-3-I12-30",\n        "TM1610-3-I12-32": "TM1610-3-I12-32"\n    },\n    "rois": {\n        "0": {\n            "EV_ROIS": [\n                {\n                    "CENTER": 1200.0,\n                    "DATA_LEVEL": false,\n                    "DWELL": 10.0,\n                    "ENABLED": false,\n                    "EPU_ANG_PNTS": [\n                        0.0\n                    ],\n                    "EPU_OFF_PNTS": [\n                        0.0\n                    ],\n                    "EPU_POL_PNTS": [\n                        -1\n                    ],\n                    "EV_BOUNDARY_ROI_START": 1200.0,\n                    "EV_POL_ORDER": 0,\n                    "HDW_ACCEL_AUTO": true,\n                    "HDW_ACCEL_REINIT": false,\n                    "HDW_ACCEL_USE": false,\n                    "ID": "EV_ROI",\n                    "ID_VAL": -1,\n                    "IS_POINT": false,\n                    "NAME": "EV",\n                    "NPOINTS": 1,\n                    "OFFSET": 0.0,\n                    "POL_ID": 1,\n                    "POL_ROIS": [\n                        {\n                            "ANGLE": 0.0,\n                            "ID": "EPU_POL",\n                            "ID_VAL": -1,\n                            "NAME": "",\n                            "OFF": 0.0,\n                            "OFF_POSITIONER": "DNM_EPU_OFFSET",\n                            "POL": -1,\n                            "POL_POSITIONER": "DNM_EPU_POLARIZATION"\n                        }\n                    ],\n                    "POSITIONER": "DNM_ENERGY",\n                    "RANGE": 0.0,\n                    "SCAN_IDX": null,\n                    "SCAN_RES": "FINE",\n                    "SETPOINTS": [\n                        1200.0\n                    ],\n                    "SRC": null,\n                    "START": 1200.0,\n                    "STEP": 0.0,\n                    "STOP": 1200.0,\n                    "TOP_LEVEL": false,\n                    "XMCD_EN": false\n                }\n            ],\n            "GONI": {\n                "T": {\n                    "CENTER": null,\n                    "DATA_LEVEL": false,\n                    "ENABLED": false,\n                    "ID": "BASE_ROI",\n                    "ID_VAL": -1,\n                    "IS_POINT": false,\n                    "NAME": "GONI.T",\n                    "NPOINTS": 0,\n                    "OFFSET": 0.0,\n                    "POSITIONER": "DNM_GONI_THETA",\n                    "RANGE": null,\n                    "SCAN_RES": null,\n                    "SRC": null,\n                    "START": null,\n                    "STEP": null,\n                    "STOP": null,\n                    "TOP_LEVEL": false\n                },\n                "X": {\n                    "CENTER": null,\n                    "DATA_LEVEL": false,\n                    "ENABLED": false,\n                    "ID": "BASE_ROI",\n                    "ID_VAL": -1,\n                    "IS_POINT": false,\n                    "NAME": "GONI.X",\n                    "NPOINTS": 50,\n                    "OFFSET": 0.0,\n                    "POSITIONER": "DNM_GONI_X",\n                    "RANGE": null,\n                    "SCAN_RES": null,\n                    "SRC": null,\n                    "START": null,\n                    "STEP": null,\n                    "STOP": null,\n                    "TOP_LEVEL": false\n                },\n                "Y": {\n                    "CENTER": null,\n                    "DATA_LEVEL": false,\n                    "ENABLED": false,\n                    "ID": "BASE_ROI",\n                    "ID_VAL": -1,\n                    "IS_POINT": false,\n                    "NAME": "GONI.Y",\n                    "NPOINTS": 50,\n                    "OFFSET": 0.0,\n                    "POSITIONER": "DNM_GONI_Y",\n                    "RANGE": null,\n                    "SCAN_RES": null,\n                    "SRC": null,\n                    "START": null,\n                    "STEP": null,\n                    "STOP": null,\n                    "TOP_LEVEL": false\n                },\n                "Z": {\n                    "CENTER": null,\n                    "DATA_LEVEL": false,\n                    "ENABLED": false,\n                    "ID": "BASE_ROI",\n                    "ID_VAL": -1,\n                    "IS_POINT": false,\n                    "NAME": "GONI.Z",\n                    "NPOINTS": 50,\n                    "OFFSET": 0.0,\n                    "POSITIONER": "DNM_GONI_Z",\n                    "RANGE": null,\n                    "SCAN_RES": null,\n                    "SRC": null,\n                    "START": null,\n                    "STEP": null,\n                    "STOP": null,\n                    "TOP_LEVEL": false\n                }\n            },\n            "OSA": {\n                "X": {\n                    "CENTER": null,\n                    "DATA_LEVEL": false,\n                    "ENABLED": false,\n                    "ID": "BASE_ROI",\n                    "ID_VAL": -1,\n                    "IS_POINT": false,\n                    "NAME": "OSA.X",\n                    "NPOINTS": 50,\n                    "OFFSET": 0.0,\n                    "POSITIONER": "DNM_OSA_X",\n                    "RANGE": null,\n                    "SCAN_RES": null,\n                    "SRC": null,\n                    "START": null,\n                    "STEP": null,\n                    "STOP": null,\n                    "TOP_LEVEL": false\n                },\n                "Y": {\n                    "CENTER": null,\n                    "DATA_LEVEL": false,\n                    "ENABLED": false,\n                    "ID": "BASE_ROI",\n                    "ID_VAL": -1,\n                    "IS_POINT": false,\n                    "NAME": "OSA.Y",\n                    "NPOINTS": 50,\n                    "OFFSET": 0.0,\n                    "POSITIONER": "DNM_OSA_Y",\n                    "RANGE": null,\n                    "SCAN_RES": null,\n                    "SRC": null,\n                    "START": null,\n                    "STEP": null,\n                    "STOP": null,\n                    "TOP_LEVEL": false\n                },\n                "Z": {\n                    "CENTER": null,\n                    "DATA_LEVEL": false,\n                    "ENABLED": false,\n                    "ID": "BASE_ROI",\n                    "ID_VAL": -1,\n                    "IS_POINT": false,\n                    "NAME": "OSA.Z",\n                    "NPOINTS": 50,\n                    "OFFSET": 0.0,\n                    "POSITIONER": "DNM_OSA_Z",\n                    "RANGE": null,\n                    "SCAN_RES": null,\n                    "SRC": null,\n                    "START": null,\n                    "STEP": null,\n                    "STOP": null,\n                    "TOP_LEVEL": false\n                }\n            },\n            "X": {\n                "CENTER": 0.0,\n                "DATA_LEVEL": false,\n                "ENABLED": true,\n                "ID": "BASE_ROI",\n                "ID_VAL": -1,\n                "IS_POINT": false,\n                "NAME": "X",\n                "NPOINTS": 300,\n                "OFFSET": 0.0,\n                "POSITIONER": "DNM_SAMPLE_X",\n                "RANGE": 2000.0,\n                "RECT": [\n                    -1000.0,\n                    -1000.0,\n                    1000.0,\n                    1000.0\n                ],\n                "SCAN_RES": "COARSE",\n                "SETPOINTS": [\n                    -1000.0,\n                    -993.3110367892976,\n                    -986.6220735785953,\n                    -979.9331103678929,\n                    -973.2441471571906,\n                    -966.5551839464883,\n                    -959.866220735786,\n                    -953.1772575250836,\n                    -946.4882943143813,\n                    -939.7993311036789,\n                    -933.1103678929766,\n                    -926.4214046822742,\n                    -919.7324414715719,\n                    -913.0434782608695,\n                    -906.3545150501673,\n                    -899.6655518394649,\n                    -892.9765886287626,\n                    -886.2876254180602,\n                    -879.5986622073578,\n                    -872.9096989966555,\n                    -866.2207357859531,\n                    -859.5317725752509,\n                    -852.8428093645484,\n                    -846.1538461538462,\n                    -839.4648829431438,\n                    -832.7759197324415,\n                    -826.0869565217391,\n                    -819.3979933110368,\n                    -812.7090301003344,\n                    -806.0200668896321,\n                    -799.3311036789298,\n                    -792.6421404682275,\n                    -785.9531772575251,\n                    -779.2642140468228,\n                    -772.5752508361204,\n                    -765.886287625418,\n                    -759.1973244147157,\n                    -752.5083612040133,\n                    -745.819397993311,\n                    -739.1304347826087,\n                    -732.4414715719063,\n                    -725.752508361204,\n                    -719.0635451505017,\n                    -712.3745819397993,\n                    -705.685618729097,\n                    -698.9966555183946,\n                    -692.3076923076924,\n                    -685.6187290969899,\n                    -678.9297658862877,\n                    -672.2408026755852,\n                    -665.551839464883,\n                    -658.8628762541806,\n                    -652.1739130434783,\n                    -645.4849498327759,\n                    -638.7959866220735,\n                    -632.1070234113713,\n                    -625.4180602006688,\n                    -618.7290969899666,\n                    -612.0401337792642,\n                    -605.3511705685619,\n                    -598.6622073578595,\n                    -591.9732441471572,\n                    -585.2842809364549,\n                    -578.5953177257525,\n                    -571.9063545150502,\n                    -565.2173913043478,\n                    -558.5284280936455,\n                    -551.8394648829432,\n                    -545.1505016722408,\n                    -538.4615384615385,\n                    -531.7725752508361,\n                    -525.0836120401339,\n                    -518.3946488294314,\n                    -511.7056856187291,\n                    -505.01672240802674,\n                    -498.32775919732444,\n                    -491.6387959866221,\n                    -484.94983277591973,\n                    -478.2608695652174,\n                    -471.571906354515,\n                    -464.88294314381267,\n                    -458.1939799331103,\n                    -451.5050167224081,\n                    -444.8160535117057,\n                    -438.12709030100336,\n                    -431.438127090301,\n                    -424.74916387959865,\n                    -418.0602006688963,\n                    -411.37123745819395,\n                    -404.6822742474916,\n                    -397.99331103678935,\n                    -391.304347826087,\n                    -384.61538461538464,\n                    -377.9264214046823,\n                    -371.23745819397993,\n                    -364.5484949832776,\n                    -357.8595317725752,\n                    -351.17056856187287,\n                    -344.4816053511705,\n                    -337.7926421404683,\n                    -331.1036789297659,\n                    -324.41471571906357,\n                    -317.7257525083612,\n                    -311.03678929765886,\n                    -304.3478260869565,\n                    -297.65886287625415,\n                    -290.9698996655518,\n                    -284.28093645484955,\n                    -277.5919732441472,\n                    -270.90301003344484,\n                    -264.2140468227425,\n                    -257.52508361204013,\n                    -250.83612040133778,\n                    -244.14715719063543,\n                    -237.45819397993307,\n                    -230.76923076923072,\n                    -224.08026755852848,\n                    -217.39130434782612,\n                    -210.70234113712377,\n                    -204.0133779264214,\n                    -197.32441471571906,\n                    -190.6354515050167,\n                    -183.94648829431435,\n                    -177.257525083612,\n                    -170.56856187290975,\n                    -163.8795986622074,\n                    -157.19063545150505,\n                    -150.5016722408027,\n                    -143.81270903010034,\n                    -137.12374581939798,\n                    -130.43478260869563,\n                    -123.74581939799327,\n                    -117.05685618729092,\n                    -110.36789297658868,\n                    -103.67892976588632,\n                    -96.98996655518397,\n                    -90.30100334448161,\n                    -83.61204013377926,\n                    -76.9230769230769,\n                    -70.23411371237455,\n                    -63.5451505016722,\n                    -56.856187290969956,\n                    -50.1672240802676,\n                    -43.47826086956525,\n                    -36.78929765886289,\n                    -30.100334448160538,\n                    -23.411371237458184,\n                    -16.72240802675583,\n                    -10.033444816053475,\n                    -3.3444816053511204,\n                    3.3444816053511204,\n                    10.033444816053475,\n                    16.72240802675583,\n                    23.411371237458184,\n                    30.100334448160538,\n                    36.78929765886278,\n                    43.47826086956525,\n                    50.16722408026749,\n                    56.856187290969956,\n                    63.5451505016722,\n                    70.23411371237466,\n                    76.9230769230769,\n                    83.61204013377937,\n                    90.30100334448161,\n                    96.98996655518386,\n                    103.67892976588632,\n                    110.36789297658856,\n                    117.05685618729103,\n                    123.74581939799327,\n                    130.43478260869574,\n                    137.12374581939798,\n                    143.81270903010022,\n                    150.5016722408027,\n                    157.19063545150493,\n                    163.8795986622074,\n                    170.56856187290964,\n                    177.2575250836121,\n                    183.94648829431435,\n                    190.63545150501682,\n                    197.32441471571906,\n                    204.0133779264213,\n                    210.70234113712377,\n                    217.391304347826,\n                    224.08026755852848,\n                    230.76923076923072,\n                    237.45819397993318,\n                    244.14715719063543,\n                    250.8361204013379,\n                    257.52508361204013,\n                    264.2140468227424,\n                    270.90301003344484,\n                    277.5919732441471,\n                    284.28093645484955,\n                    290.9698996655518,\n                    297.65886287625426,\n                    304.3478260869565,\n                    311.03678929765897,\n                    317.7257525083612,\n                    324.41471571906345,\n                    331.1036789297659,\n                    337.79264214046816,\n                    344.48160535117063,\n                    351.17056856187287,\n                    357.85953177257534,\n                    364.5484949832776,\n                    371.2374581939798,\n                    377.9264214046823,\n                    384.6153846153845,\n                    391.304347826087,\n                    397.99331103678924,\n                    404.6822742474917,\n                    411.37123745819395,\n                    418.0602006688964,\n                    424.74916387959865,\n                    431.4381270903009,\n                    438.12709030100336,\n                    444.8160535117056,\n                    451.5050167224081,\n                    458.1939799331103,\n                    464.8829431438128,\n                    471.571906354515,\n                    478.2608695652175,\n                    484.94983277591973,\n                    491.638795986622,\n                    498.32775919732444,\n                    505.0167224080267,\n                    511.70568561872915,\n                    518.3946488294314,\n                    525.0836120401339,\n                    531.7725752508361,\n                    538.4615384615386,\n                    545.1505016722408,\n                    551.839464882943,\n                    558.5284280936455,\n                    565.2173913043478,\n                    571.9063545150502,\n                    578.5953177257525,\n                    585.2842809364549,\n                    591.9732441471572,\n                    598.6622073578594,\n                    605.3511705685619,\n                    612.0401337792641,\n                    618.7290969899666,\n                    625.4180602006688,\n                    632.1070234113713,\n                    638.7959866220735,\n                    645.484949832776,\n                    652.1739130434783,\n                    658.8628762541805,\n                    665.551839464883,\n                    672.2408026755852,\n                    678.9297658862877,\n                    685.6187290969899,\n                    692.3076923076924,\n                    698.9966555183946,\n                    705.6856187290971,\n                    712.3745819397993,\n                    719.0635451505016,\n                    725.752508361204,\n                    732.4414715719063,\n                    739.1304347826087,\n                    745.819397993311,\n                    752.5083612040135,\n                    759.1973244147157,\n                    765.8862876254182,\n                    772.5752508361204,\n                    779.2642140468226,\n                    785.9531772575251,\n                    792.6421404682274,\n                    799.3311036789298,\n                    806.0200668896321,\n                    812.7090301003345,\n                    819.3979933110368,\n                    826.0869565217392,\n                    832.7759197324415,\n                    839.4648829431437,\n                    846.1538461538462,\n                    852.8428093645484,\n                    859.5317725752509,\n                    866.2207357859531,\n                    872.9096989966556,\n                    879.5986622073578,\n                    886.2876254180601,\n                    892.9765886287626,\n                    899.6655518394648,\n                    906.3545150501673,\n                    913.0434782608695,\n                    919.732441471572,\n                    926.4214046822742,\n                    933.1103678929767,\n                    939.7993311036789,\n                    946.4882943143812,\n                    953.1772575250836,\n                    959.8662207357859,\n                    966.5551839464883,\n                    973.2441471571906,\n                    979.933110367893,\n                    986.6220735785953,\n                    993.3110367892978,\n                    1000.0\n                ],\n                "SRC": null,\n                "START": -1000.0,\n                "STEP": 6.688963210702341,\n                "STOP": 1000.0,\n                "TOP_LEVEL": false\n            },\n            "Y": {\n                "CENTER": -804.26,\n                "DATA_LEVEL": false,\n                "ENABLED": true,\n                "ID": "BASE_ROI",\n                "ID_VAL": -1,\n                "IS_POINT": false,\n                "NAME": "Y",\n                "NPOINTS": 100,\n                "OFFSET": 0.0,\n                "POSITIONER": "DNM_SAMPLE_Y",\n                "RANGE": 2000.0,\n                "RECT": [\n                    -1804.26,\n                    -1804.26,\n                    195.74,\n                    195.74\n                ],\n                "SCAN_RES": "COARSE",\n                "SETPOINTS": [\n                    -1804.26,\n                    -1784.05797979798,\n                    -1763.8559595959596,\n                    -1743.6539393939395,\n                    -1723.4519191919192,\n                    -1703.249898989899,\n                    -1683.0478787878787,\n                    -1662.8458585858587,\n                    -1642.6438383838383,\n                    -1622.4418181818182,\n                    -1602.239797979798,\n                    -1582.0377777777778,\n                    -1561.8357575757575,\n                    -1541.6337373737374,\n                    -1521.431717171717,\n                    -1501.229696969697,\n                    -1481.027676767677,\n                    -1460.8256565656566,\n                    -1440.6236363636363,\n                    -1420.4216161616162,\n                    -1400.219595959596,\n                    -1380.0175757575757,\n                    -1359.8155555555556,\n                    -1339.6135353535353,\n                    -1319.4115151515152,\n                    -1299.209494949495,\n                    -1279.0074747474748,\n                    -1258.8054545454547,\n                    -1238.6034343434344,\n                    -1218.401414141414,\n                    -1198.199393939394,\n                    -1177.997373737374,\n                    -1157.7953535353536,\n                    -1137.5933333333332,\n                    -1117.3913131313132,\n                    -1097.189292929293,\n                    -1076.9872727272727,\n                    -1056.7852525252524,\n                    -1036.5832323232323,\n                    -1016.3812121212121,\n                    -996.1791919191919,\n                    -975.9771717171718,\n                    -955.7751515151516,\n                    -935.5731313131314,\n                    -915.3711111111112,\n                    -895.169090909091,\n                    -874.9670707070708,\n                    -854.7650505050506,\n                    -834.5630303030304,\n                    -814.3610101010102,\n                    -794.15898989899,\n                    -773.9569696969697,\n                    -753.7549494949496,\n                    -733.5529292929293,\n                    -713.3509090909092,\n                    -693.1488888888889,\n                    -672.9468686868688,\n                    -652.7448484848485,\n                    -632.5428282828284,\n                    -612.3408080808081,\n                    -592.138787878788,\n                    -571.9367676767677,\n                    -551.7347474747476,\n                    -531.5327272727272,\n                    -511.33070707070715,\n                    -491.12868686868705,\n                    -470.92666666666673,\n                    -450.72464646464664,\n                    -430.5226262626263,\n                    -410.3206060606062,\n                    -390.1185858585859,\n                    -369.9165656565658,\n                    -349.7145454545455,\n                    -329.5125252525254,\n                    -309.31050505050507,\n                    -289.108484848485,\n                    -268.90646464646466,\n                    -248.70444444444456,\n                    -228.50242424242424,\n                    -208.30040404040415,\n                    -188.09838383838382,\n                    -167.89636363636373,\n                    -147.69434343434364,\n                    -127.49232323232332,\n                    -107.29030303030322,\n                    -87.0882828282829,\n                    -66.8862626262628,\n                    -46.684242424242484,\n                    -26.48222222222239,\n                    -6.2802020202020685,\n                    13.921818181818026,\n                    34.12383838383835,\n                    54.32585858585844,\n                    74.52787878787876,\n                    94.72989898989886,\n                    114.93191919191918,\n                    135.13393939393927,\n                    155.33595959595937,\n                    175.5379797979797,\n                    195.74\n                ],\n                "SRC": null,\n                "START": -1804.26,\n                "STEP": 20.2020202020202,\n                "STOP": 195.74,\n                "TOP_LEVEL": false\n            },\n            "Z": {\n                "CENTER": 0,\n                "DATA_LEVEL": false,\n                "ENABLED": false,\n                "ID": "BASE_ROI",\n                "ID_VAL": -1,\n                "IS_POINT": false,\n                "NAME": "Z",\n                "NPOINTS": 0,\n                "OFFSET": 0.0,\n                "POSITIONER": "DNM_DETECTOR_Z",\n                "RANGE": 0,\n                "SCAN_RES": null,\n                "SETPOINTS": [],\n                "SRC": null,\n                "START": 0,\n                "STEP": 0,\n                "STOP": 0,\n                "TOP_LEVEL": false\n            },\n            "ZP": {\n                "X": {\n                    "CENTER": null,\n                    "DATA_LEVEL": false,\n                    "ENABLED": false,\n                    "ID": "BASE_ROI",\n                    "ID_VAL": -1,\n                    "IS_POINT": false,\n                    "NAME": "ZP.X",\n                    "NPOINTS": 0,\n                    "OFFSET": 0.0,\n                    "POSITIONER": "DNM_ZONEPLATE_X",\n                    "RANGE": null,\n                    "SCAN_RES": null,\n                    "SRC": null,\n                    "START": null,\n                    "STEP": null,\n                    "STOP": null,\n                    "TOP_LEVEL": false\n                },\n                "Y": {\n                    "CENTER": null,\n                    "DATA_LEVEL": false,\n                    "ENABLED": false,\n                    "ID": "BASE_ROI",\n                    "ID_VAL": -1,\n                    "IS_POINT": false,\n                    "NAME": "GONI.Y",\n                    "NPOINTS": 0,\n                    "OFFSET": 0.0,\n                    "POSITIONER": "DNM_ZONEPLATE_Y",\n                    "RANGE": null,\n                    "SCAN_RES": null,\n                    "SRC": null,\n                    "START": null,\n                    "STEP": null,\n                    "STOP": null,\n                    "TOP_LEVEL": false\n                },\n                "Z": {\n                    "CENTER": null,\n                    "DATA_LEVEL": false,\n                    "ENABLED": false,\n                    "ID": "BASE_ROI",\n                    "ID_VAL": -1,\n                    "IS_POINT": false,\n                    "NAME": "GONI.Z",\n                    "NPOINTS": 0,\n                    "OFFSET": 0.0,\n                    "POSITIONER": "DNM_ZONEPLATE_Z",\n                    "RANGE": null,\n                    "SCAN_RES": null,\n                    "SRC": null,\n                    "START": null,\n                    "STEP": null,\n                    "STOP": null,\n                    "TOP_LEVEL": false\n                }\n            }\n        }\n    },\n    "rotation_angle": 0.0,\n    "scan_type": 9,\n    "sequence_map": "{\\n    \\"0\\": {\\n        \\"e_idx\\": 0,\\n        \\"entry\\": \\"entry0\\",\\n        \\"pol_idx\\": 0,\\n        \\"sp_id\\": 0,\\n        \\"sp_idx\\": 0\\n    }\\n}",\n    "sp_id_lst": [\n        0\n    ],\n    "wdg_com": "{\\n    \\"CMND\\": 0,\\n    \\"SINGLE_LST\\": {\\n        \\"DWELL\\": [],\\n        \\"EV_ROIS\\": [],\\n        \\"POL_ROIS\\": [],\\n        \\"SP_ROIS\\": []\\n    },\\n    \\"SPATIAL_ROIS\\": {\\n        \\"0\\": {\\n            \\"ACTIVE_DATA_OBJ\\": {\\n                \\"CFG\\": {\\n                    \\"CUR_EV_IDX\\": null,\\n                    \\"CUR_SAMPLE_POS\\": null,\\n                    \\"CUR_SEQ_NUM\\": null,\\n                    \\"CUR_SPATIAL_ROI_IDX\\": null,\\n                    \\"DATA_DIR\\": \\"G:\\\\\\\\nexus\\\\\\\\nexusformat\\\\\\\\stxm_test\\\\\\\\guest\\\\\\\\0323\\",\\n                    \\"DATA_EXT\\": \\"hdf5\\",\\n                    \\"DATA_FILE_NAME\\": \\"C230323001.hdf5\\",\\n                    \\"DATA_IMG_IDX\\": 0,\\n                    \\"DATA_STATUS\\": \\"NOT_FINISHED\\",\\n                    \\"DATA_THUMB_NAME\\": \\"C230323001\\",\\n                    \\"PREFIX\\": \\"C230323001\\",\\n                    \\"ROI\\": null,\\n                    \\"SCAN_TYPE\\": null,\\n                    \\"STACK_DIR\\": \\"G:\\\\\\\\nexus\\\\\\\\nexusformat\\\\\\\\stxm_test\\\\\\\\guest\\\\\\\\0323\\\\\\\\C230323001\\",\\n                    \\"THUMB_EXT\\": \\"jpg\\",\\n                    \\"UNIQUEID\\": null,\\n                    \\"WDG_COM\\": null\\n                },\\n                \\"DATA\\": {\\n                    \\"POINTS\\": null,\\n                    \\"SSCANS\\": {}\\n                },\\n                \\"DEVICES\\": null,\\n                \\"END_TIME\\": null,\\n                \\"START_TIME\\": null,\\n                \\"VERSION\\": null\\n            },\\n            \\"CMND\\": 0,\\n            \\"EV_NPOINTS\\": 1,\\n            \\"EV_ROIS\\": [\\n                {\\n                    \\"CENTER\\": 1200.0,\\n                    \\"DATA_LEVEL\\": false,\\n                    \\"DWELL\\": 10.0,\\n                    \\"ENABLED\\": false,\\n                    \\"EPU_ANG_PNTS\\": [\\n                        0.0\\n                    ],\\n                    \\"EPU_OFF_PNTS\\": [\\n                        0.0\\n                    ],\\n                    \\"EPU_POL_PNTS\\": [\\n                        -1\\n                    ],\\n                    \\"EV_BOUNDARY_ROI_START\\": 1200.0,\\n                    \\"EV_POL_ORDER\\": 0,\\n                    \\"HDW_ACCEL_AUTO\\": true,\\n                    \\"HDW_ACCEL_REINIT\\": false,\\n                    \\"HDW_ACCEL_USE\\": false,\\n                    \\"ID\\": \\"EV_ROI\\",\\n                    \\"ID_VAL\\": -1,\\n                    \\"IS_POINT\\": false,\\n                    \\"NAME\\": \\"EV\\",\\n                    \\"NPOINTS\\": 1,\\n                    \\"OFFSET\\": 0.0,\\n                    \\"POL_ID\\": 1,\\n                    \\"POL_ROIS\\": [\\n                        {\\n                            \\"ANGLE\\": 0.0,\\n                            \\"ID\\": \\"EPU_POL\\",\\n                            \\"ID_VAL\\": -1,\\n                            \\"NAME\\": \\"\\",\\n                            \\"OFF\\": 0.0,\\n                            \\"OFF_POSITIONER\\": \\"DNM_EPU_OFFSET\\",\\n                            \\"POL\\": -1,\\n                            \\"POL_POSITIONER\\": \\"DNM_EPU_POLARIZATION\\"\\n                        }\\n                    ],\\n                    \\"POSITIONER\\": \\"DNM_ENERGY\\",\\n                    \\"RANGE\\": 0.0,\\n                    \\"SCAN_IDX\\": null,\\n                    \\"SCAN_RES\\": \\"FINE\\",\\n                    \\"SETPOINTS\\": [\\n                        1200.0\\n                    ],\\n                    \\"SRC\\": null,\\n                    \\"START\\": 1200.0,\\n                    \\"STEP\\": 0.0,\\n                    \\"STOP\\": 1200.0,\\n                    \\"TOP_LEVEL\\": false,\\n                    \\"XMCD_EN\\": false\\n                }\\n            ],\\n            \\"GONI\\": {\\n                \\"T\\": {\\n                    \\"CENTER\\": null,\\n                    \\"DATA_LEVEL\\": false,\\n                    \\"ENABLED\\": false,\\n                    \\"ID\\": \\"BASE_ROI\\",\\n                    \\"ID_VAL\\": -1,\\n                    \\"IS_POINT\\": false,\\n                    \\"NAME\\": \\"GONI.T\\",\\n                    \\"NPOINTS\\": 0,\\n                    \\"OFFSET\\": 0.0,\\n                    \\"POSITIONER\\": \\"DNM_GONI_THETA\\",\\n                    \\"RANGE\\": null,\\n                    \\"SCAN_RES\\": null,\\n                    \\"SRC\\": null,\\n                    \\"START\\": null,\\n                    \\"STEP\\": null,\\n                    \\"STOP\\": null,\\n                    \\"TOP_LEVEL\\": false\\n                },\\n                \\"X\\": {\\n                    \\"CENTER\\": null,\\n                    \\"DATA_LEVEL\\": false,\\n                    \\"ENABLED\\": false,\\n                    \\"ID\\": \\"BASE_ROI\\",\\n                    \\"ID_VAL\\": -1,\\n                    \\"IS_POINT\\": false,\\n                    \\"NAME\\": \\"GONI.X\\",\\n                    \\"NPOINTS\\": 50,\\n                    \\"OFFSET\\": 0.0,\\n                    \\"POSITIONER\\": \\"DNM_GONI_X\\",\\n                    \\"RANGE\\": null,\\n                    \\"SCAN_RES\\": null,\\n                    \\"SRC\\": null,\\n                    \\"START\\": null,\\n                    \\"STEP\\": null,\\n                    \\"STOP\\": null,\\n                    \\"TOP_LEVEL\\": false\\n                },\\n                \\"Y\\": {\\n                    \\"CENTER\\": null,\\n                    \\"DATA_LEVEL\\": false,\\n                    \\"ENABLED\\": false,\\n                    \\"ID\\": \\"BASE_ROI\\",\\n                    \\"ID_VAL\\": -1,\\n                    \\"IS_POINT\\": false,\\n                    \\"NAME\\": \\"GONI.Y\\",\\n                    \\"NPOINTS\\": 50,\\n                    \\"OFFSET\\": 0.0,\\n                    \\"POSITIONER\\": \\"DNM_GONI_Y\\",\\n                    \\"RANGE\\": null,\\n                    \\"SCAN_RES\\": null,\\n                    \\"SRC\\": null,\\n                    \\"START\\": null,\\n                    \\"STEP\\": null,\\n                    \\"STOP\\": null,\\n                    \\"TOP_LEVEL\\": false\\n                },\\n                \\"Z\\": {\\n                    \\"CENTER\\": null,\\n                    \\"DATA_LEVEL\\": false,\\n                    \\"ENABLED\\": false,\\n                    \\"ID\\": \\"BASE_ROI\\",\\n                    \\"ID_VAL\\": -1,\\n                    \\"IS_POINT\\": false,\\n                    \\"NAME\\": \\"GONI.Z\\",\\n                    \\"NPOINTS\\": 50,\\n                    \\"OFFSET\\": 0.0,\\n                    \\"POSITIONER\\": \\"DNM_GONI_Z\\",\\n                    \\"RANGE\\": null,\\n                    \\"SCAN_RES\\": null,\\n                    \\"SRC\\": null,\\n                    \\"START\\": null,\\n                    \\"STEP\\": null,\\n                    \\"STOP\\": null,\\n                    \\"TOP_LEVEL\\": false\\n                },\\n                \\"ZPZ_ADJUST\\": {\\n                    \\"CENTER\\": null,\\n                    \\"DATA_LEVEL\\": false,\\n                    \\"ENABLED\\": false,\\n                    \\"ID\\": \\"BASE_ROI\\",\\n                    \\"ID_VAL\\": -1,\\n                    \\"IS_POINT\\": false,\\n                    \\"NAME\\": \\"GONI.ZPZ_ADJUST\\",\\n                    \\"NPOINTS\\": 0,\\n                    \\"OFFSET\\": 0.0,\\n                    \\"POSITIONER\\": \\"\\",\\n                    \\"RANGE\\": null,\\n                    \\"SCAN_RES\\": null,\\n                    \\"SRC\\": null,\\n                    \\"START\\": null,\\n                    \\"STEP\\": null,\\n                    \\"STOP\\": null,\\n                    \\"TOP_LEVEL\\": false\\n                }\\n            },\\n            \\"ID\\": \\"SPATIAL_DB_DICT\\",\\n            \\"ID_VAL\\": 0,\\n            \\"OSA\\": {\\n                \\"X\\": {\\n                    \\"CENTER\\": null,\\n                    \\"DATA_LEVEL\\": false,\\n                    \\"ENABLED\\": false,\\n                    \\"ID\\": \\"BASE_ROI\\",\\n                    \\"ID_VAL\\": -1,\\n                    \\"IS_POINT\\": false,\\n                    \\"NAME\\": \\"OSA.X\\",\\n                    \\"NPOINTS\\": 50,\\n                    \\"OFFSET\\": 0.0,\\n                    \\"POSITIONER\\": \\"DNM_OSA_X\\",\\n                    \\"RANGE\\": null,\\n                    \\"SCAN_RES\\": null,\\n                    \\"SRC\\": null,\\n                    \\"START\\": null,\\n                    \\"STEP\\": null,\\n                    \\"STOP\\": null,\\n                    \\"TOP_LEVEL\\": false\\n                },\\n                \\"Y\\": {\\n                    \\"CENTER\\": null,\\n                    \\"DATA_LEVEL\\": false,\\n                    \\"ENABLED\\": false,\\n                    \\"ID\\": \\"BASE_ROI\\",\\n                    \\"ID_VAL\\": -1,\\n                    \\"IS_POINT\\": false,\\n                    \\"NAME\\": \\"OSA.Y\\",\\n                    \\"NPOINTS\\": 50,\\n                    \\"OFFSET\\": 0.0,\\n                    \\"POSITIONER\\": \\"DNM_OSA_Y\\",\\n                    \\"RANGE\\": null,\\n                    \\"SCAN_RES\\": null,\\n                    \\"SRC\\": null,\\n                    \\"START\\": null,\\n                    \\"STEP\\": null,\\n                    \\"STOP\\": null,\\n                    \\"TOP_LEVEL\\": false\\n                },\\n                \\"Z\\": {\\n                    \\"CENTER\\": null,\\n                    \\"DATA_LEVEL\\": false,\\n                    \\"ENABLED\\": false,\\n                    \\"ID\\": \\"BASE_ROI\\",\\n                    \\"ID_VAL\\": -1,\\n                    \\"IS_POINT\\": false,\\n                    \\"NAME\\": \\"OSA.Z\\",\\n                    \\"NPOINTS\\": 50,\\n                    \\"OFFSET\\": 0.0,\\n                    \\"POSITIONER\\": \\"DNM_OSA_Z\\",\\n                    \\"RANGE\\": null,\\n                    \\"SCAN_RES\\": null,\\n                    \\"SRC\\": null,\\n                    \\"START\\": null,\\n                    \\"STEP\\": null,\\n                    \\"STOP\\": null,\\n                    \\"TOP_LEVEL\\": false\\n                }\\n            },\\n            \\"PLOT\\": {\\n                \\"IMAGE_TYPE\\": 2,\\n                \\"ITEM\\": {\\n                    \\"ID\\": \\"0 1\\",\\n                    \\"TITLE\\": null\\n                },\\n                \\"KEY_PRESSED\\": null,\\n                \\"SHAPE_TYPE\\": 0\\n            },\\n            \\"RECT\\": [\\n                -1000.0,\\n                -1804.26,\\n                1000.0,\\n                195.74\\n            ],\\n            \\"SCAN_PLUGIN\\": {\\n                \\"DATA_FILE_PFX\\": \\"B\\",\\n                \\"MAX_SCANRANGE\\": [\\n                    null,\\n                    null\\n                ],\\n                \\"SCAN_PANEL_IDX\\": 3,\\n                \\"SCAN_SUBTYPE\\": 1,\\n                \\"SCAN_TYPE\\": 9,\\n                \\"SECTION_ID\\": \\"COARSE_IMAGE\\"\\n            },\\n            \\"SPATIAL_ROIS_CENTER\\": [\\n                null,\\n                null\\n            ],\\n            \\"SUB_SPATIAL_ROIS\\": null,\\n            \\"X\\": {\\n                \\"CENTER\\": 0.0,\\n                \\"DATA_LEVEL\\": false,\\n                \\"ENABLED\\": true,\\n                \\"ID\\": \\"BASE_ROI\\",\\n                \\"ID_VAL\\": -1,\\n                \\"IS_POINT\\": false,\\n                \\"NAME\\": \\"X\\",\\n                \\"NPOINTS\\": 300,\\n                \\"OFFSET\\": 0.0,\\n                \\"POSITIONER\\": \\"DNM_SAMPLE_X\\",\\n                \\"RANGE\\": 2000.0,\\n                \\"RECT\\": [\\n                    -1000.0,\\n                    -1000.0,\\n                    1000.0,\\n                    1000.0\\n                ],\\n                \\"SCAN_RES\\": \\"COARSE\\",\\n                \\"SETPOINTS\\": [\\n                    -1000.0,\\n                    -993.3110367892976,\\n                    -986.6220735785953,\\n                    -979.9331103678929,\\n                    -973.2441471571906,\\n                    -966.5551839464883,\\n                    -959.866220735786,\\n                    -953.1772575250836,\\n                    -946.4882943143813,\\n                    -939.7993311036789,\\n                    -933.1103678929766,\\n                    -926.4214046822742,\\n                    -919.7324414715719,\\n                    -913.0434782608695,\\n                    -906.3545150501673,\\n                    -899.6655518394649,\\n                    -892.9765886287626,\\n                    -886.2876254180602,\\n                    -879.5986622073578,\\n                    -872.9096989966555,\\n                    -866.2207357859531,\\n                    -859.5317725752509,\\n                    -852.8428093645484,\\n                    -846.1538461538462,\\n                    -839.4648829431438,\\n                    -832.7759197324415,\\n                    -826.0869565217391,\\n                    -819.3979933110368,\\n                    -812.7090301003344,\\n                    -806.0200668896321,\\n                    -799.3311036789298,\\n                    -792.6421404682275,\\n                    -785.9531772575251,\\n                    -779.2642140468228,\\n                    -772.5752508361204,\\n                    -765.886287625418,\\n                    -759.1973244147157,\\n                    -752.5083612040133,\\n                    -745.819397993311,\\n                    -739.1304347826087,\\n                    -732.4414715719063,\\n                    -725.752508361204,\\n                    -719.0635451505017,\\n                    -712.3745819397993,\\n                    -705.685618729097,\\n                    -698.9966555183946,\\n                    -692.3076923076924,\\n                    -685.6187290969899,\\n                    -678.9297658862877,\\n                    -672.2408026755852,\\n                    -665.551839464883,\\n                    -658.8628762541806,\\n                    -652.1739130434783,\\n                    -645.4849498327759,\\n                    -638.7959866220735,\\n                    -632.1070234113713,\\n                    -625.4180602006688,\\n                    -618.7290969899666,\\n                    -612.0401337792642,\\n                    -605.3511705685619,\\n                    -598.6622073578595,\\n                    -591.9732441471572,\\n                    -585.2842809364549,\\n                    -578.5953177257525,\\n                    -571.9063545150502,\\n                    -565.2173913043478,\\n                    -558.5284280936455,\\n                    -551.8394648829432,\\n                    -545.1505016722408,\\n                    -538.4615384615385,\\n                    -531.7725752508361,\\n                    -525.0836120401339,\\n                    -518.3946488294314,\\n                    -511.7056856187291,\\n                    -505.01672240802674,\\n                    -498.32775919732444,\\n                    -491.6387959866221,\\n                    -484.94983277591973,\\n                    -478.2608695652174,\\n                    -471.571906354515,\\n                    -464.88294314381267,\\n                    -458.1939799331103,\\n                    -451.5050167224081,\\n                    -444.8160535117057,\\n                    -438.12709030100336,\\n                    -431.438127090301,\\n                    -424.74916387959865,\\n                    -418.0602006688963,\\n                    -411.37123745819395,\\n                    -404.6822742474916,\\n                    -397.99331103678935,\\n                    -391.304347826087,\\n                    -384.61538461538464,\\n                    -377.9264214046823,\\n                    -371.23745819397993,\\n                    -364.5484949832776,\\n                    -357.8595317725752,\\n                    -351.17056856187287,\\n                    -344.4816053511705,\\n                    -337.7926421404683,\\n                    -331.1036789297659,\\n                    -324.41471571906357,\\n                    -317.7257525083612,\\n                    -311.03678929765886,\\n                    -304.3478260869565,\\n                    -297.65886287625415,\\n                    -290.9698996655518,\\n                    -284.28093645484955,\\n                    -277.5919732441472,\\n                    -270.90301003344484,\\n                    -264.2140468227425,\\n                    -257.52508361204013,\\n                    -250.83612040133778,\\n                    -244.14715719063543,\\n                    -237.45819397993307,\\n                    -230.76923076923072,\\n                    -224.08026755852848,\\n                    -217.39130434782612,\\n                    -210.70234113712377,\\n                    -204.0133779264214,\\n                    -197.32441471571906,\\n                    -190.6354515050167,\\n                    -183.94648829431435,\\n                    -177.257525083612,\\n                    -170.56856187290975,\\n                    -163.8795986622074,\\n                    -157.19063545150505,\\n                    -150.5016722408027,\\n                    -143.81270903010034,\\n                    -137.12374581939798,\\n                    -130.43478260869563,\\n                    -123.74581939799327,\\n                    -117.05685618729092,\\n                    -110.36789297658868,\\n                    -103.67892976588632,\\n                    -96.98996655518397,\\n                    -90.30100334448161,\\n                    -83.61204013377926,\\n                    -76.9230769230769,\\n                    -70.23411371237455,\\n                    -63.5451505016722,\\n                    -56.856187290969956,\\n                    -50.1672240802676,\\n                    -43.47826086956525,\\n                    -36.78929765886289,\\n                    -30.100334448160538,\\n                    -23.411371237458184,\\n                    -16.72240802675583,\\n                    -10.033444816053475,\\n                    -3.3444816053511204,\\n                    3.3444816053511204,\\n                    10.033444816053475,\\n                    16.72240802675583,\\n                    23.411371237458184,\\n                    30.100334448160538,\\n                    36.78929765886278,\\n                    43.47826086956525,\\n                    50.16722408026749,\\n                    56.856187290969956,\\n                    63.5451505016722,\\n                    70.23411371237466,\\n                    76.9230769230769,\\n                    83.61204013377937,\\n                    90.30100334448161,\\n                    96.98996655518386,\\n                    103.67892976588632,\\n                    110.36789297658856,\\n                    117.05685618729103,\\n                    123.74581939799327,\\n                    130.43478260869574,\\n                    137.12374581939798,\\n                    143.81270903010022,\\n                    150.5016722408027,\\n                    157.19063545150493,\\n                    163.8795986622074,\\n                    170.56856187290964,\\n                    177.2575250836121,\\n                    183.94648829431435,\\n                    190.63545150501682,\\n                    197.32441471571906,\\n                    204.0133779264213,\\n                    210.70234113712377,\\n                    217.391304347826,\\n                    224.08026755852848,\\n                    230.76923076923072,\\n                    237.45819397993318,\\n                    244.14715719063543,\\n                    250.8361204013379,\\n                    257.52508361204013,\\n                    264.2140468227424,\\n                    270.90301003344484,\\n                    277.5919732441471,\\n                    284.28093645484955,\\n                    290.9698996655518,\\n                    297.65886287625426,\\n                    304.3478260869565,\\n                    311.03678929765897,\\n                    317.7257525083612,\\n                    324.41471571906345,\\n                    331.1036789297659,\\n                    337.79264214046816,\\n                    344.48160535117063,\\n                    351.17056856187287,\\n                    357.85953177257534,\\n                    364.5484949832776,\\n                    371.2374581939798,\\n                    377.9264214046823,\\n                    384.6153846153845,\\n                    391.304347826087,\\n                    397.99331103678924,\\n                    404.6822742474917,\\n                    411.37123745819395,\\n                    418.0602006688964,\\n                    424.74916387959865,\\n                    431.4381270903009,\\n                    438.12709030100336,\\n                    444.8160535117056,\\n                    451.5050167224081,\\n                    458.1939799331103,\\n                    464.8829431438128,\\n                    471.571906354515,\\n                    478.2608695652175,\\n                    484.94983277591973,\\n                    491.638795986622,\\n                    498.32775919732444,\\n                    505.0167224080267,\\n                    511.70568561872915,\\n                    518.3946488294314,\\n                    525.0836120401339,\\n                    531.7725752508361,\\n                    538.4615384615386,\\n                    545.1505016722408,\\n                    551.839464882943,\\n                    558.5284280936455,\\n                    565.2173913043478,\\n                    571.9063545150502,\\n                    578.5953177257525,\\n                    585.2842809364549,\\n                    591.9732441471572,\\n                    598.6622073578594,\\n                    605.3511705685619,\\n                    612.0401337792641,\\n                    618.7290969899666,\\n                    625.4180602006688,\\n                    632.1070234113713,\\n                    638.7959866220735,\\n                    645.484949832776,\\n                    652.1739130434783,\\n                    658.8628762541805,\\n                    665.551839464883,\\n                    672.2408026755852,\\n                    678.9297658862877,\\n                    685.6187290969899,\\n                    692.3076923076924,\\n                    698.9966555183946,\\n                    705.6856187290971,\\n                    712.3745819397993,\\n                    719.0635451505016,\\n                    725.752508361204,\\n                    732.4414715719063,\\n                    739.1304347826087,\\n                    745.819397993311,\\n                    752.5083612040135,\\n                    759.1973244147157,\\n                    765.8862876254182,\\n                    772.5752508361204,\\n                    779.2642140468226,\\n                    785.9531772575251,\\n                    792.6421404682274,\\n                    799.3311036789298,\\n                    806.0200668896321,\\n                    812.7090301003345,\\n                    819.3979933110368,\\n                    826.0869565217392,\\n                    832.7759197324415,\\n                    839.4648829431437,\\n                    846.1538461538462,\\n                    852.8428093645484,\\n                    859.5317725752509,\\n                    866.2207357859531,\\n                    872.9096989966556,\\n                    879.5986622073578,\\n                    886.2876254180601,\\n                    892.9765886287626,\\n                    899.6655518394648,\\n                    906.3545150501673,\\n                    913.0434782608695,\\n                    919.732441471572,\\n                    926.4214046822742,\\n                    933.1103678929767,\\n                    939.7993311036789,\\n                    946.4882943143812,\\n                    953.1772575250836,\\n                    959.8662207357859,\\n                    966.5551839464883,\\n                    973.2441471571906,\\n                    979.933110367893,\\n                    986.6220735785953,\\n                    993.3110367892978,\\n                    1000.0\\n                ],\\n                \\"SRC\\": null,\\n                \\"START\\": -1000.0,\\n                \\"STEP\\": 6.688963210702341,\\n                \\"STOP\\": 1000.0,\\n                \\"TOP_LEVEL\\": false\\n            },\\n            \\"Y\\": {\\n                \\"CENTER\\": -804.26,\\n                \\"DATA_LEVEL\\": false,\\n                \\"ENABLED\\": true,\\n                \\"ID\\": \\"BASE_ROI\\",\\n                \\"ID_VAL\\": -1,\\n                \\"IS_POINT\\": false,\\n                \\"NAME\\": \\"Y\\",\\n                \\"NPOINTS\\": 100,\\n                \\"OFFSET\\": 0.0,\\n                \\"POSITIONER\\": \\"DNM_SAMPLE_Y\\",\\n                \\"RANGE\\": 2000.0,\\n                \\"RECT\\": [\\n                    -1804.26,\\n                    -1804.26,\\n                    195.74,\\n                    195.74\\n                ],\\n                \\"SCAN_RES\\": \\"COARSE\\",\\n                \\"SETPOINTS\\": [\\n                    -1804.26,\\n                    -1784.05797979798,\\n                    -1763.8559595959596,\\n                    -1743.6539393939395,\\n                    -1723.4519191919192,\\n                    -1703.249898989899,\\n                    -1683.0478787878787,\\n                    -1662.8458585858587,\\n                    -1642.6438383838383,\\n                    -1622.4418181818182,\\n                    -1602.239797979798,\\n                    -1582.0377777777778,\\n                    -1561.8357575757575,\\n                    -1541.6337373737374,\\n                    -1521.431717171717,\\n                    -1501.229696969697,\\n                    -1481.027676767677,\\n                    -1460.8256565656566,\\n                    -1440.6236363636363,\\n                    -1420.4216161616162,\\n                    -1400.219595959596,\\n                    -1380.0175757575757,\\n                    -1359.8155555555556,\\n                    -1339.6135353535353,\\n                    -1319.4115151515152,\\n                    -1299.209494949495,\\n                    -1279.0074747474748,\\n                    -1258.8054545454547,\\n                    -1238.6034343434344,\\n                    -1218.401414141414,\\n                    -1198.199393939394,\\n                    -1177.997373737374,\\n                    -1157.7953535353536,\\n                    -1137.5933333333332,\\n                    -1117.3913131313132,\\n                    -1097.189292929293,\\n                    -1076.9872727272727,\\n                    -1056.7852525252524,\\n                    -1036.5832323232323,\\n                    -1016.3812121212121,\\n                    -996.1791919191919,\\n                    -975.9771717171718,\\n                    -955.7751515151516,\\n                    -935.5731313131314,\\n                    -915.3711111111112,\\n                    -895.169090909091,\\n                    -874.9670707070708,\\n                    -854.7650505050506,\\n                    -834.5630303030304,\\n                    -814.3610101010102,\\n                    -794.15898989899,\\n                    -773.9569696969697,\\n                    -753.7549494949496,\\n                    -733.5529292929293,\\n                    -713.3509090909092,\\n                    -693.1488888888889,\\n                    -672.9468686868688,\\n                    -652.7448484848485,\\n                    -632.5428282828284,\\n                    -612.3408080808081,\\n                    -592.138787878788,\\n                    -571.9367676767677,\\n                    -551.7347474747476,\\n                    -531.5327272727272,\\n                    -511.33070707070715,\\n                    -491.12868686868705,\\n                    -470.92666666666673,\\n                    -450.72464646464664,\\n                    -430.5226262626263,\\n                    -410.3206060606062,\\n                    -390.1185858585859,\\n                    -369.9165656565658,\\n                    -349.7145454545455,\\n                    -329.5125252525254,\\n                    -309.31050505050507,\\n                    -289.108484848485,\\n                    -268.90646464646466,\\n                    -248.70444444444456,\\n                    -228.50242424242424,\\n                    -208.30040404040415,\\n                    -188.09838383838382,\\n                    -167.89636363636373,\\n                    -147.69434343434364,\\n                    -127.49232323232332,\\n                    -107.29030303030322,\\n                    -87.0882828282829,\\n                    -66.8862626262628,\\n                    -46.684242424242484,\\n                    -26.48222222222239,\\n                    -6.2802020202020685,\\n                    13.921818181818026,\\n                    34.12383838383835,\\n                    54.32585858585844,\\n                    74.52787878787876,\\n                    94.72989898989886,\\n                    114.93191919191918,\\n                    135.13393939393927,\\n                    155.33595959595937,\\n                    175.5379797979797,\\n                    195.74\\n                ],\\n                \\"SRC\\": null,\\n                \\"START\\": -1804.26,\\n                \\"STEP\\": 20.2020202020202,\\n                \\"STOP\\": 195.74,\\n                \\"TOP_LEVEL\\": false\\n            },\\n            \\"Z\\": {\\n                \\"CENTER\\": 0,\\n                \\"DATA_LEVEL\\": false,\\n                \\"ENABLED\\": false,\\n                \\"ID\\": \\"BASE_ROI\\",\\n                \\"ID_VAL\\": -1,\\n                \\"IS_POINT\\": false,\\n                \\"NAME\\": \\"Z\\",\\n                \\"NPOINTS\\": 0,\\n                \\"OFFSET\\": 0.0,\\n                \\"POSITIONER\\": \\"DNM_DETECTOR_Z\\",\\n                \\"RANGE\\": 0,\\n                \\"SCAN_RES\\": null,\\n                \\"SETPOINTS\\": [],\\n                \\"SRC\\": null,\\n                \\"START\\": 0,\\n                \\"STEP\\": 0,\\n                \\"STOP\\": 0,\\n                \\"TOP_LEVEL\\": false\\n            },\\n            \\"ZP\\": {\\n                \\"X\\": {\\n                    \\"CENTER\\": null,\\n                    \\"DATA_LEVEL\\": false,\\n                    \\"ENABLED\\": false,\\n                    \\"ID\\": \\"BASE_ROI\\",\\n                    \\"ID_VAL\\": -1,\\n                    \\"IS_POINT\\": false,\\n                    \\"NAME\\": \\"ZP.X\\",\\n                    \\"NPOINTS\\": 0,\\n                    \\"OFFSET\\": 0.0,\\n                    \\"POSITIONER\\": \\"DNM_ZONEPLATE_X\\",\\n                    \\"RANGE\\": null,\\n                    \\"SCAN_RES\\": null,\\n                    \\"SRC\\": null,\\n                    \\"START\\": null,\\n                    \\"STEP\\": null,\\n                    \\"STOP\\": null,\\n                    \\"TOP_LEVEL\\": false\\n                },\\n                \\"Y\\": {\\n                    \\"CENTER\\": null,\\n                    \\"DATA_LEVEL\\": false,\\n                    \\"ENABLED\\": false,\\n                    \\"ID\\": \\"BASE_ROI\\",\\n                    \\"ID_VAL\\": -1,\\n                    \\"IS_POINT\\": false,\\n                    \\"NAME\\": \\"GONI.Y\\",\\n                    \\"NPOINTS\\": 0,\\n                    \\"OFFSET\\": 0.0,\\n                    \\"POSITIONER\\": \\"DNM_ZONEPLATE_Y\\",\\n                    \\"RANGE\\": null,\\n                    \\"SCAN_RES\\": null,\\n                    \\"SRC\\": null,\\n                    \\"START\\": null,\\n                    \\"STEP\\": null,\\n                    \\"STOP\\": null,\\n                    \\"TOP_LEVEL\\": false\\n                },\\n                \\"Z\\": {\\n                    \\"CENTER\\": null,\\n                    \\"DATA_LEVEL\\": false,\\n                    \\"ENABLED\\": false,\\n                    \\"ID\\": \\"BASE_ROI\\",\\n                    \\"ID_VAL\\": -1,\\n                    \\"IS_POINT\\": false,\\n                    \\"NAME\\": \\"GONI.Z\\",\\n                    \\"NPOINTS\\": 0,\\n                    \\"OFFSET\\": 0.0,\\n                    \\"POSITIONER\\": \\"DNM_ZONEPLATE_Z\\",\\n                    \\"RANGE\\": null,\\n                    \\"SCAN_RES\\": null,\\n                    \\"SRC\\": null,\\n                    \\"START\\": null,\\n                    \\"STEP\\": null,\\n                    \\"STOP\\": null,\\n                    \\"TOP_LEVEL\\": false\\n                }\\n            }\\n        }\\n    }\\n}",\n    "zp_def": {\n        "Cz_pos": 56.42857142857143,\n        "Zpz_pos": -2054.6,\n        "fl": -200.0,\n        "zpA1": -4.524,\n        "zpCStop": 60.0,\n        "zpD": 140.0,\n        "zpOZone": 40.0,\n        "zp_idx": 3\n    }\n}'}
def make_lxl_scan_plan(dets, md=None, bi_dir=False):
    """
    This produces a line by line scan that uses base level plans to do the scan
    due to the sis3820 requiring it to be running before the X motor moves across the scan line

    :param dets:
    :param gate:
    :param bi_dir:
    :return:
    """
    # get the accel distance for now from the app configuration
    ACCEL_DISTANCE_PERCENT_OF_RANGE = MAIN_OBJ.get_preset_as_float("coarse_accel_dist_percent_of_range")
    ACCEL_DISTANCE = x_roi["RANGE"] * ACCEL_DISTANCE_PERCENT_OF_RANGE

    skip_lst = ["DNM_COARSE_X", "DNM_COARSE_Y"]


    _bi_dir = False
    _md = self.make_standard_metadata(entry_name="entry0", scan_type=self.scan_type, dets=dets)
    # reset the default detector to the line detector as it is set to DEFAULT_COUNTER by default
    dnms = self.dets_names([self.main_obj.device("DNM_LINE_DET")])
    _md["default_det"] = dnms[0]
    if md is None:
        md = {
            "metadata": dict_to_json(_md)
        }

    @bpp.baseline_decorator(dev_list)
    @bpp.run_decorator(md=md)
    def do_scan():
        try:
            print('entering BaseCoarseImageScanClass: line_by_line do_scan')

            psmtr_x = self.main_obj.device("DNM_SAMPLE_X")
            psmtr_y = self.main_obj.device("DNM_SAMPLE_Y")
            crs_x = self.main_obj.device("DNM_SCANCOARSE_X")
            crs_y = self.main_obj.device("DNM_SCANCOARSE_Y")
            shutter = self.main_obj.device("DNM_SHUTTER")
            piezo_mtr = self.main_obj.device("DNM_SAMPLE_FINE_X")
            # return_velo = self.get_mtr_max_velo(crs_x)
            return_velo = 3500.0
            psmtr_x.set_piezo_power_off()
            psmtr_y.set_piezo_power_off()
            # make sure that the positions of the piezos are correct to start
            # yield from bps.mv(psmtr_x.set_coarse_pos, 1, group="SETCOARSEPOS")
            # yield from bps.mv(psmtr_y.set_coarse_pos, 1, group="SETCOARSEPOS")
            # yield from bps.wait("SETCOARSEPOS")
            shutter.open()

            print("ACCEL_DISTANCE=%.2f" % ACCEL_DISTANCE)
            # scan_velo = self.x_roi["RANGE"] / ((self.x_roi["NPOINTS"] * self.dwell) * 0.001)
            sisdev = dets[0]
            piezo_mtr.scan_start.put(self.x_roi['START'] - ACCEL_DISTANCE)
            piezo_mtr.scan_stop.put(self.x_roi['STOP'] + ACCEL_DISTANCE)
            piezo_mtr.marker_start.put(self.x_roi['START'])
            piezo_mtr.marker_stop.put(self.x_roi['STOP'])
            piezo_mtr.set_marker.put(self.x_roi['START'])
            piezo_mtr.set_marker_position(self.x_roi['START'])

            # move to scan start
            yield from bps.mv(crs_x, self.x_roi['START'] - ACCEL_DISTANCE, group='BB')
            yield from bps.mv(crs_y, self.y_roi['START'], group='BB')
            yield from bps.wait('BB')

            for y_sp in self.y_roi['SETPOINTS']:
                crs_x.velocity.put(self.scan_velo)
                piezo_mtr.enable_marker_position(True)
                yield from bps.mv(sisdev.run, 1, group='SIS3820')
                yield from bps.mv(crs_y, y_sp)
                yield from bps.mv(crs_x, self.x_roi['STOP'] + ACCEL_DISTANCE, group='BB')
                yield from bps.wait('BB')
                yield from bps.trigger_and_read(dets)
                piezo_mtr.enable_marker_position(False)
                crs_x.velocity.put(return_velo)
                yield from bps.mv(crs_x, self.x_roi['START'] - ACCEL_DISTANCE, group='CC')
                # yield from bps.wait('CC')

            shutter.close()
            print("CoarseSampleImageScanClass LxL: make_scan_plan Leaving")
        # except NameError as ne:
        #     # Code to handle NameError
        #     print(ne)
        except LimitError as le:
            print(f"There was a problem involving a motor setpoint being larger than valid range: [{le}]")

        except FailedStatus as fe:
            print(f"Most likely a motor is sitting on a limit: [{fe}]")

    return (yield from do_scan())